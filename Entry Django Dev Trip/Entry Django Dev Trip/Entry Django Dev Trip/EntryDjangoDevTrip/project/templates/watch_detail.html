
{% extends 'base.html' %}

{% block content %}
<div class="header-container">
    <div class="background-image">
        <div class="watch-detail-image1">
            {% if watch.image %}
            <img src="{{ watch.image.url }}" alt="{{ watch.title }}" class="detail-image1">
            {% else %}
            <div class="placeholder-image">No Image Available</div>
            {% endif %}
        </div>
    </div>
    
    <nav class="navbar">
        <div class="nav-links">
            <a href="#">WATCHES</a>
            <a href="#">MAISON</a>
            <a href="#">SERVICES</a>
            <a href="#">BOUTIQUES</a>
        </div>
        
        <div class="logo">
            <svg title="Vacheron Constantin" itemprop="logo" width="156" height="13" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 156 13" xmlns:v="https://vecta.io/nano" class="vac-logo__img vac-logo__img--full"><path d="M67.9 6.5l-1-2.9 5.4 2.3h.1c.1 0 .2 0 .3-.1s.1-.2.1-.3v-.1L70.4 0l2.9 1.1L76.2 0l-2.3 5.4v.1c0 .1 0 .2.1.3s.2.1.3.1h.1l5.4-2.3-1 2.9 1 2.9-5.4-2.3h-.1c-.1 0-.2 0-.3.1s-.1.2-.1.3v.1l2.3 5.4-2.9-1.1 -2.8 1.1 2.3-5.4v-.1c0-.1 0-.2-.1-.3s-.2-.1-.3-.1h-.1l-5.4 2.3 1-2.9zM8 1L5.4 12H3.9L1.2 1h1.7l1.8 8.2L6.4 1H8zm7.5 11h-1.7l-.5-2.2h-3L9.7 12H8l2.8-11h1.9l2.8 11zm-4.7-4.1h2l-1.1-4.2-.9 4.2zm12.7.3c0 1.1-.5 2.4-1.1 3-.5.5-1.4 1-2.3 1.1-1.8.1-3-1.5-3.4-3.8-.1-.5-.2-1.2-.2-1.9s0-1.5.2-2.1c.5-2 1.4-3.7 3.5-3.7.6 0 1.4.1 2.1.8 1.2 1.1 1.2 2.5 1.2 3h-1.6c0-.6-.4-2.2-2-2-.8.1-1.3.8-1.6 1.7-.1.4-.2 1.1-.3 1.9 0 .8 0 1.6.3 2.3.3.8.6 1.3 1 1.5.2.1.4.2.6.2s.5 0 .7-.1c1.1-.4 1.2-1.5 1.2-2l1.7.1zM25 1h1.6v4.1h3.2V1h1.6v11h-1.6V7h-3.2v5H25V1zm14.1 0v1.9H35v2.5h3.8v1.9H35v2.8h4.3V12h-6V1h5.8zm1.8 0h4.4c.8 0 1.6.6 1.8 1.7.2.6.4 1.3.2 2.3-.2.9-.5 1.3-1.1 1.7.3.3.8.5.9 1.5l.1 2.4c0 .6.1.8.3.9v.5h-1.8c-.1-.3-.2-.7-.2-1V8.8c0-.7-.4-1.1-1-1.1h-1.9V12H41l-.1-11zm1.7 4.8h2.3c.4 0 1.1-.6 1-1.6 0-.8-.3-1.2-1-1.2h-2.2v2.8zM55.2 11c-.7.9-1.6 1.4-2.7 1.4a3.19 3.19 0 0 1-2.7-1.4c-.8-1.1-1.2-2.7-1.2-4.4s.4-3.3 1.2-4.4c.7-.9 1.6-1.4 2.7-1.4a3.19 3.19 0 0 1 2.7 1.4c.8 1.1 1.2 2.7 1.2 4.4 0 1.6-.5 3.3-1.2 4.4zM54 9.6c.5-.7.8-1.8.8-3s-.3-2.4-.8-3c-.4-.5-.9-.7-1.5-.7-.5 0-1 .2-1.5.7-.5.7-.8 1.8-.8 3s.3 2.4.8 3c.4.5.9.7 1.5.7s1.1-.2 1.5-.7z"></path><use xlink:href="#logo-top"></use><path d="M89.3 8.2c0 1.1-.5 2.4-1.1 3-.5.5-1.4 1-2.3 1.1-1.8.1-3-1.5-3.4-3.8-.1-.5-.2-1.2-.2-1.9s0-1.5.2-2.1C83 2.5 83.9.8 86 .8c.6 0 1.4.1 2.1.8 1.2 1.1 1.2 2.5 1.2 3h-1.6c0-.6-.4-2.2-2-2-.8.1-1.3.8-1.6 1.7-.1.4-.2 1.1-.3 1.9 0 .8 0 1.6.3 2.3.3.8.6 1.3 1 1.5.2.1.4.2.6.2s.5 0 .7-.1c1.1-.4 1.2-1.5 1.2-2l1.7.1zM97 11c-.7.9-1.6 1.4-2.7 1.4a3.19 3.19 0 0 1-2.7-1.4c-.8-1.1-1.2-2.7-1.2-4.4s.4-3.3 1.2-4.4c.7-.9 1.6-1.4 2.7-1.4A3.19 3.19 0 0 1 97 2.2c.8 1.1 1.2 2.7 1.2 4.4 0 1.6-.5 3.3-1.2 4.4zm-1.2-1.4c.5-.7.8-1.8.8-3s-.3-2.4-.8-3c-.4-.5-.9-.7-1.5-.7-.5 0-1 .2-1.5.7-.5.7-.8 1.8-.8 3s.3 2.4.8 3c.4.5.9.7 1.5.7.5 0 1.1-.2 1.5-.7z"></path><use xlink:href="#logo-top" x="41.7"></use><path d="M112.2 4.4c0-.9-.5-1.7-1.6-1.7-.8 0-1.4.4-1.4 1.3 0 .8.1.9.5 1.1.2.3 1.7.6 2 .7.4.1 1.4.4 1.9 1.1.9 1.3.5 3.9-.5 4.8-.7.6-1.6.8-2.5.8-.4 0-1.4-.2-2-.8-.7-.7-1.1-1.8-1.1-2.8h1.6c0 .3.1.7.3 1.1.4.5 1 .7 1.5.6.5 0 1.1-.2 1.3-.5.3-.5.4-1.3 0-1.8-.5-.8-2.1-.8-3.1-1.2-.9-.4-1.6-1.3-1.5-3s1-3 3-3c.4 0 1.9 0 2.7 1.4.4.7.5 1.7.5 2.1l-1.6-.2zm9-3.4v1.9h-2.3v9h-1.7v-9h-2.4V1h6.4zm7.2 11h-1.7l-.5-2.2h-3l-.6 2.2H121l2.8-11h1.9l2.7 11zm-4.6-4.1h2l-1.1-4.2-.9 4.2z"></path><use xlink:href="#logo-top" x="71.8"></use><path d="M143.7 1v1.9h-2.3v9h-1.6v-9h-2.4V1h6.3zm2.8 11h-1.6V1h1.6v11z"></path><use xlink:href="#logo-top" x="90.4"></use><defs><path id="logo-top" d="M59.5 1l3.2 7.5V1h1.6v11h-1.6l-3.2-7.6V12h-1.6V1h1.6z"></path></defs></svg>
        </div>
        
        <div class="right-menu">
            <a href="#">CONTACT</a>
            <a href="#">WW / EN</a>
            <span class="search-icon">⌕</span>
        </div>
    </nav>
</div>
    
    <div class="watch-gallery-section">
        <h2 class="section-title">{{ watch.title }}</h2>
        <h2 class="section-title">{{ watch.description }}</h2>


        <div class="watch-gallery">
            {% for image in watch.images.all|slice:":3" %}
                <div class="gallery-item">
                    <img src="{{ image.image.url }}" alt="{{ watch.title }} - Изображение {{ forloop.counter }}" class="gallery-image">
                </div>
            {% empty %}
                <div class="gallery-item">
                    <div class="placeholder-image">Изображения не доступны</div>
                </div>
                <div class="gallery-item">
                    <div class="placeholder-image">Изображения не доступны</div>
                </div>
                <div class="gallery-item">
                    <div class="placeholder-image">Изображения не доступны</div>
                </div>
            {% endfor %}
        </div>
    </div>
    <div class="video-section">
        {% if watch.video %}
        <div class="video-container">
            <p>Видео</p>
            <video autoplay muted loop playsinline class="watch-video">
                <source src="{{ watch.video.url }}" type="video/mp4">
                Ваш браузер не поддерживает видео
            </video>
        </div>
        {% endif %}
    </div>
    <div class="author-carousel-section">
        <div class="carousel-container">
            <div class="carousel-track">
                <div class="carousel-slide author-slide">
                    <div class="author-info">
                        <div class="author-image">
                            {% if watch.author.picture %}
                            <img src="{{ watch.author.picture.url }}" alt="{{ watch.author.name }}" class="author-picture">
                            {% else %}
                            <div class="placeholder-image">Фото автора не доступно</div>
                            {% endif %}
                        </div>
                        <div class="author-details">
                            <h3 class="author-name">{{ watch.author.name }}</h3>
                            <p class="author-bio">{{ watch.author.bio }}</p>
                        </div>
                    </div>
                </div>
                
                {% for author_watch in author_works %}
                <div class="carousel-slide author-work-slide">
                    <div class="author-work">
                        <div class="author-work-image">
                            {% if author_watch.image %}
                            <img src="{{ author_watch.image.url }}" alt="{{ author_watch.title }}" class="work-image">
                            {% else %}
                            <div class="placeholder-image">Изображение не доступно</div>
                            {% endif %}
                        </div>
                        <div class="author-work-details">
                            <h3 class="work-title">{{ author_watch.title }}</h3>
                            <p class="work-price">{{ author_watch.price }} €</p>
                            <a href="{{ author_watch.get_absolute_url }}" class="view-details-btn">Подробнее</a>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            
            <!-- Навигация карусели -->
            <div class="carousel-nav">
                <button class="carousel-prev-btn">&lt;</button>
                <div class="carousel-dots">
                    <span class="carousel-dot active" data-slide="0"></span>
                    {% for author_watch in author_works %}
                    <span class="carousel-dot" data-slide="{{ forloop.counter }}"></span>
                    {% endfor %}
                </div>
                <button class="carousel-next-btn">&gt;</button>
            </div>
        </div>
    </div>
</div>

<style>
    /* Существующие стили из вашего кода */
    .watch-detail-container {
        margin: 3rem auto;
        padding: 2rem;
        background: white;
        border-radius: 8px;
    }

    .watch-detail-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 2rem;
        border-bottom: 1px solid #eee;
        padding-bottom: 1rem;
    }

    .watch-detail-header h1 {
        font-size: 2rem;
        margin: 0;
        color: #333;
    }

    .watch-brand-badge {
        background: #f0f0f0;
        padding: 0.5rem 1rem;
        border-radius: 4px;
        font-weight: bold;
        color: #555;
    }

    .watch-detail-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 3rem;
    }

    .watch-detail-image {
        display: flex;
        justify-content: center;
        align-items: center;
        background: #f9f9f9;
        border-radius: 8px;
        overflow: hidden;
    }

    .detail-image {
        max-width: 100%;
        height: auto;
        max-height: 500px;
        object-fit: contain;
    }

    .placeholder-image {
        height: 400px;
        width: 100%;
        display: flex;
        justify-content: center;
        align-items: center;
        background: #f0f0f0;
        color: #999;
        font-size: 1.2rem;
    }

    .watch-price {
        font-size: 1.8rem;
        margin-bottom: 2rem;
        color: #333;
    }

    .price-label {
        font-weight: normal;
        margin-right: 0.5rem;
    }

    .price-value {
        font-weight: bold;
        color: #e63946;
    }

    .watch-specs {
        margin-bottom: 2rem;
    }

    .watch-specs h3, .watch-description h3 {
        font-size: 1.4rem;
        margin-bottom: 1rem;
        color: #333;
        border-bottom: 1px solid #eee;
        padding-bottom: 0.5rem;
    }

    .specs-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1rem;
    }

    .spec-item {
        padding: 0.5rem;
        background: #f9f9f9;
        border-radius: 4px;
    }

    .spec-label {
        font-weight: bold;
        color: #555;
        margin-right: 0.5rem;
    }

    .watch-description {
        margin-bottom: 2rem;
    }

    .watch-description p {
        line-height: 1.6;
        color: #555;
    }

    .watch-actions {
        display: flex;
        gap: 1rem;
        margin-top: 2rem;
    }

    .action-btn {
        padding: 0.8rem 1.5rem;
        border-radius: 4px;
        border: none;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s;
    }

    .primary-btn {
        background: #1d3557;
        color: white;
    }

    .primary-btn:hover {
        background: #2c4f7c;
    }

    .wishlist-btn {
        background: white;
        color: #333;
        border: 1px solid #ddd;
    }

    .wishlist-btn:hover {
        background: #f9f9f9;
    }

    .video-section {
        margin: 4rem 0;
        background: #000;
        position: relative;
    }
    
    .video-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 2rem;
    }
    
    .watch-video {
        width: 100%;
        height: 600px;
        object-fit: cover;
        border-radius: 4px;
    }
    
    @media (max-width: 768px) {
        .video-container {
            padding: 0;
        }
        
        .watch-video {
            height: 300px;
            border-radius: 0;
        }
    }

    .back-btn {
        background: #f0f0f0;
        color: #333;
        text-decoration: none;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .back-btn:hover {
        background: #e0e0e0;
    }

    /* Responsive design */
    @media (max-width: 768px) {
        .watch-detail-grid {
            grid-template-columns: 1fr;
        }

        .specs-grid {
            grid-template-columns: 1fr;
        }

        .watch-detail-header {
            flex-direction: column;
            align-items: flex-start;
            gap: 1rem;
        }

        .watch-actions {
            flex-direction: column;
        }
    }
    * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: Arial, sans-serif;
        }
        
        .header-container {
            position: relative;
            width: 100%;
            height: 100vh;
            overflow: hidden;
            background-color: black;
        }
        
        .background-image {
            position: absolute;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: bottom;
            opacity: 0.7;
            z-index: 1;
        }

        .background-image video {
            position: absolute;
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .vac-hero-banner__background-video {
            position: relative;
            width: 100%;
            height: 100%;
        }
        
        .navbar {
            position: relative;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 50px;
            z-index: 3;
        }
        
        .nav-links {
            display: flex;
            gap: 40px;
        }
        
        .nav-links a {
            color: white;
            text-decoration: none;
            font-size: 14px;
            font-weight: 600;
            letter-spacing: 1px;
        }
        
        .logo {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
        }
        
        .logo img {
            height: 20px;
        }
        
        .right-menu {
            display: flex;
            gap: 30px;
            align-items: center;
        }
        
        .right-menu a {
            color: white;
            text-decoration: none;
            font-size: 14px;
            font-weight: 600;
            letter-spacing: 1px;
        }
        
        .search-icon {
            color: white;
            font-size: 18px;
        }
        
        .hero-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 2;
            width: 100%;
            text-align: center;
        }
        
        .watch-image {
            width: 350px;
            margin-bottom: 30px;
        }
        
        .subtitle {
            color: white;
            font-size: 14px;
            letter-spacing: 2px;
            margin-bottom: 20px;
        }
        
        .title {
            color: white;
            font-size: 48px;
            font-weight: 300;
            letter-spacing: 5px;
            margin-bottom: 30px;
            text-transform: uppercase;
        }
        
        .discover-btn {
            color: white;
            text-decoration: none;
            text-transform: uppercase;
            font-size: 12px;
            letter-spacing: 2px;
            padding: 5px 0;
            border-bottom: 1px solid white;
        }
        .vac-hero-banner__background-video {
            position: relative;
            width: 100%;
            height: 100%;
        }
        
    /* Новые стили для секции галереи */
    .section-title {
        text-align: center;
        font-size: 1.8rem;
        margin: 3rem 0 1.5rem;
        color: #333;
        border-bottom: 1px solid #eee;
        padding-bottom: 0.8rem;
        text-transform: uppercase;
        letter-spacing: 1px;
    }
    
    .watch-gallery-section {
        margin-top: 4rem;
    }
    
    .watch-gallery {
        display: flex;
        gap: 1.5rem;
        overflow-x: auto;
        padding: 1rem 0;
        scrollbar-width: thin;
        scrollbar-color: #1d3557 #f0f0f0;
    }
    
    .gallery-item {
        flex: 0 0 calc(33.33% - 1rem);
        min-width: 300px;
        height: 500px;
        border-radius: 8px;
        overflow: hidden;
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
    }
    
    .gallery-image {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: transform 0.3s ease;
    }
    
    .gallery-image:hover {
        transform: scale(1.05);
    }
    
    /* Стили для секции карусели автора */
    .author-carousel-section {
        margin-top: 4rem;
        margin-bottom: 2rem;
    }
    
    .carousel-container {
        position: relative;
        overflow: hidden;
        border-radius: 8px;
        box-shadow: 0 3px 15px rgba(0, 0, 0, 0.1);
    }
    
    .carousel-track {
        display: flex;
        transition: transform 0.5s ease;
    }
    
    .carousel-slide {
        flex: 0 0 100%;
        min-width: 100%;
        padding: 2rem;
    }
    
    .author-info {
        display: flex;
        gap: 2rem;
        align-items: center;
    }
    
    .author-image {
        height: 600px;
    }
    
    .author-picture {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }
    
    .author-details {
        flex: 1;
    }
    
    .author-name {
        font-size: 1.6rem;
        margin-bottom: 1rem;
        color: #1d3557;
    }
    
    .author-bio {
        line-height: 1.6;
        color: #555;
    }
    
    .author-work {
        display: flex;
        gap: 2rem;
        align-items: center;
    }
    
    .author-work-image {
        flex: 0 0 300px;
        height: 300px;
        border-radius: 8px;
        overflow: hidden;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }
    
    .work-image {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }
    
    .author-work-details {
        flex: 1;
    }
    
    .work-title {
        font-size: 1.6rem;
        margin-bottom: 0.5rem;
        color: #1d3557;
    }
    
    .work-price {
        font-size: 1.4rem;
        font-weight: bold;
        color: #e63946;
        margin-bottom: 1.5rem;
    }
    
    .view-details-btn {
        display: inline-block;
        padding: 0.7rem 1.5rem;
        background-color: #1d3557;
        color: white;
        text-decoration: none;
        border-radius: 4px;
        font-weight: bold;
        transition: background-color 0.3s;
    }
    
    .view-details-btn:hover {
        background-color: #2c4f7c;
    }
    
    .carousel-nav {
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 1rem 0;
        gap: 1rem;
    }
    
    .carousel-prev-btn, .carousel-next-btn {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        border: 1px solid #ddd;
        background: white;
        font-size: 1.2rem;
        cursor: pointer;
        transition: all 0.3s;
    }
    
    .carousel-prev-btn:hover, .carousel-next-btn:hover {
        background: #f0f0f0;
        border-color: #1d3557;
    }
    
    .carousel-dots {
        display: flex;
        gap: 0.5rem;
    }
    
    .carousel-dot {
        width: 10px;
        height: 10px;
        border-radius: 50%;
        background: #ddd;
        cursor: pointer;
        transition: background 0.3s;
    }
    .carousel-dot.active {
        background: #1d3557;
    }
    
    /* Адаптивный дизайн для галереи и карусели */
    @media (max-width: 992px) {
        .watch-gallery {
            flex-wrap: wrap;
        }
        
        .gallery-item {
            flex: 0 0 calc(50% - 1rem);
            min-width: 250px;
        }
        
        .author-info, .author-work {
            flex-direction: column;
            text-align: center;
        }
        
        .author-image {
            margin: 0 auto 1.5rem;
        }
        
        .author-work-image {
            margin: 0 auto 1.5rem;
        }
    }
    
    @media (max-width: 576px) {
        .gallery-item {
            flex: 0 0 100%;
        }
        
        .carousel-slide {
            padding: 1rem;
        }
    }
</style>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Инициализация карусели
        const track = document.querySelector('.carousel-track');
        const slides = document.querySelectorAll('.carousel-slide');
        const dotsContainer = document.querySelector('.carousel-dots');
        const dots = document.querySelectorAll('.carousel-dot');
        const prevButton = document.querySelector('.carousel-prev-btn');
        const nextButton = document.querySelector('.carousel-next-btn');
        
        let currentIndex = 0;
        const totalSlides = slides.length;
        
        // Функция для обновления карусели
        function updateCarousel() {
            // Обновляем положение трека
            track.style.transform = `translateX(-${currentIndex * 100}%)`;
            
            // Обновляем активную точку
            dots.forEach((dot, index) => {
                dot.classList.toggle('active', index === currentIndex);
            });
            
            // Проверяем статус кнопок навигации
            prevButton.disabled = currentIndex === 0;
            nextButton.disabled = currentIndex === totalSlides - 1;
        }
        
        // Обработчики событий для кнопок
        prevButton.addEventListener('click', function() {
            if (currentIndex > 0) {
                currentIndex--;
                updateCarousel();
            }
        });
        
        nextButton.addEventListener('click', function() {
            if (currentIndex < totalSlides - 1) {
                currentIndex++;
                updateCarousel();
            }
        });
        
        // Навигация по точкам
        dots.forEach((dot, index) => {
            dot.addEventListener('click', function() {
                currentIndex = index;
                updateCarousel();
            });
        });
        
        // Инициализируем карусель
        updateCarousel();
        
        // Добавляем прокрутку галереи мышью
        const gallery = document.querySelector('.watch-gallery');
        let isDown = false;
        let startX;
        let scrollLeft;
        
        gallery.addEventListener('mousedown', (e) => {
            isDown = true;
            startX = e.pageX - gallery.offsetLeft;
            scrollLeft = gallery.scrollLeft;
        });
        
        gallery.addEventListener('mouseleave', () => {
            isDown = false;
        });
        
        gallery.addEventListener('mouseup', () => {
            isDown = false;
        });
        
        gallery.addEventListener('mousemove', (e) => {
            if (!isDown) return;
            e.preventDefault();
            const x = e.pageX - gallery.offsetLeft;
            const walk = (x - startX) * 2; // Множитель скорости прокрутки
            gallery.scrollLeft = scrollLeft - walk;
        });
    });
</script>
{% endblock %}